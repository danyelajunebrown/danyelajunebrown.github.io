function generateReport() {
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);
            endDate.setHours(23, 59, 59, 999); // Include full end date
            
            const filteredReports = reports.filter(report => {
                const reportDate = new Date(report.timestamp);
                return reportDate >= startDate && reportDate <= endDate;
            });
            
            // Group entries by day of week
            const dayGroups = {
                'MON': [], 'TUE': [], 'WED': [], 'THU': [], 'FRI': [], 'SAT': [], 'SUN': []
            };
            
            filteredReports.forEach(report => {
                const date = new Date(report.timestamp);
                const dayNames = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];
                const dayName = dayNames[date.getDay()];
                dayGroups[dayName].push(report);
            });
            
            // Sort entries within each day by time
            Object.keys(dayGroups).forEach(day => {
                dayGroups[day].sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
            });
            
            let reportText = `DBT Skills Diary Card\n`;
            reportText += `Week Dates: ${startDate.toLocaleDateString()} - ${endDate.toLocaleDateString()}\n`;
            reportText += '=========================================================================\n\n';
            
            // Create horizontal layout
            const days = ['MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'SUN'];
            
            // Header row
            reportText += days.map(day => day.padEnd(10)).join(' | ') + '\n';
            reportText += days.map(() => '----------').join(' | ') + '\n';
            
            // Find max entries for any day to determine number of rows needed
            const maxEntries = Math.max(...days.map(day => dayGroups[day].length));
            
            // Create rows for entries
            for (let row = 0; row < Math.max(maxEntries, 1); row++) {
                const rowData = days.map(day => {
                    if (row < dayGroups[day].length) {
                        const entry = dayGroups[day][row];
                        const time = new Date(entry.timestamp).toLocaleTimeString('en-US', {
                            hour: '2-digit',
                            minute: '2-digit',
                            hour12: true
                        });
                        return `${time}\n${entry.feeling}\n(${entry.intensity})`.padEnd(10);
                    } else if (row === 0 && dayGroups[day].length === 0) {
                        return '---'.padEnd(10);
                    } else {
                        return ''.padEnd(10);
                    }
                });
                reportText += rowData.join(' | ') + '\n';
            }
            
            reportText += '\n';
            reportText += 'SKILLS USED:\n';
            reportText += days.map(day => day.padEnd(10)).join(' | ') + '\n';
            reportText += days.map(() => '----------').join(' | ') + '\n';
            
            // Skills row
            const skillsData = days.map(day => {
                const skills = dayGroups[day].map(entry => entry.dbtSkill);
                const uniqueSkills = [...new Set(skills)];
                return uniqueSkills.slice(0, 2).join('\n').padEnd(10);
            });
            reportText += skillsData.join(' | ') + '\n';
            
            // If more than 2 skills per day, add additional rows
            const maxSkills = Math.max(...days.map(day => {
                const skills = dayGroups[day].map(entry => entry.dbtSkill);
                return [...new Set(skills)].length;
            }));
            
            for (let row = 2; row < maxSkills; row++) {
                const skillsRowData = days.map(day => {
                    const skills = dayGroups[day].map(entry => entry.dbtSkill);
                    const uniqueSkills = [...new Set(skills)];
                    return (uniqueSkills[row] || '').padEnd(10);
                });
                reportText += skillsRowData.join(' | ') + '\n';
            }
            
            reportText += '\n=========================================================================\n';
            reportText += 'Generated by DBT Skills Tracker';
            
            document.getElementById('reportText').textContent = reportText;
            hideDateModal();
            reportModal.style.display = 'block';
        }
